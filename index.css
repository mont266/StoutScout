@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html,
  body,
  #root {
    @apply h-full;
    /* This ensures a consistent height chain for the app to fill the viewport */
  }

  html {
    /* Prevent horizontal scrollbars which can cause unwanted white space */
    overflow-x: hidden;
  }

  body {
    @apply bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-white font-sans antialiased;
    /* Prevent the browser's native pull-to-refresh action */
    overscroll-behavior-y: contain;
    /* Add padding for device notches and system UI (status bar, home indicator) */
    padding-top: env(safe-area-inset-top);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
}

@layer components {
  /* This class is used in MobileLayout.jsx to add padding for the home indicator */
  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom);
  }

  /*
    Adds a colored strip at the bottom for native Android to provide spacing
    for the system navigation bar. This is needed because the webview does not
    respect safe-area-insets reliably for the bottom navigation bar.
    This is achieved using a flexbox pseudo-element (`::after`) within the
    main container. This method contains the spacing *within* the viewport height,
    preventing unwanted vertical scrolling.
  */
  .native-android .mobile-layout-container::after {
    content: '';
    display: block;
    height: 1rem; /* Creates the space at the bottom */
    flex-shrink: 0;
    background-color: #ffffff; /* Matches light mode Header/TabBar */
  }

  .dark.native-android .mobile-layout-container::after {
    background-color: #1f2937; /* Matches dark mode Header/TabBar (gray-800) */
  }
  
  /* New class to adjust scroll-to-top button on native Android */
  .native-android .scroll-to-top-android-fix {
    /* bottom-24 is 6rem. Add 2rem for the android nav bar padding. 8rem is bottom-32. */
    bottom: 8rem;
  }


  #orientation-lock-overlay {
    @apply fixed inset-0 z-[100] bg-gray-900 text-white flex-col items-center justify-center text-center p-8 hidden; /* hidden by default */
  }

  /* New styles for the improved overlay */
  .phone-graphic {
    @apply relative w-24 h-48;
    animation: rotate-hint 3s ease-in-out infinite;
  }
  
  .phone-outline, .stoutly-logo {
    @apply absolute top-0 left-0 w-full h-full;
  }

  .stoutly-logo {
    @apply p-6; /* Add padding to fit the logo nicely inside the phone */
  }

  @keyframes rotate-hint {
    0% { transform: rotate(90deg); }
    30% { transform: rotate(0deg); }
    70% { transform: rotate(0deg); }
    100% { transform: rotate(90deg); }
  }

  .app-header, .community-header, .feed-header {
    transition: transform 0.3s ease-in-out;
  }
  .app-header.hide-header, .community-header.hide-header, .feed-header.hide-header {
      transform: translateY(-100%);
  }

  .community-tabs-container {
    transition: all 0.3s ease-in-out;
    max-height: 6rem; /* A safe large value */
    overflow: hidden;
  }
  .community-tabs-container.hide {
      max-height: 0;
      border-bottom-width: 0;
      opacity: 0;
  }
}

/* Show overlay and hide app only on mobile devices in landscape.
   We use max-height as a proxy for a phone, as a phone's height in landscape
   is much smaller than its width, and smaller than a tablet's height. */
@media (orientation: landscape) and (max-height: 600px) {
  #root, #modal-root {
    display: none; /* Hide the app content */
  }
  #orientation-lock-overlay {
    display: flex; /* Show the overlay */
  }
}

.map-tiles-dark {
  filter: brightness(1.4) contrast(0.9) saturate(0.9);
}

@keyframes highlight {
  0% { background-color: rgba(251, 191, 36, 0); } /* amber-400 */
  50% { background-color: rgba(251, 191, 36, 0.3); }
  100% { background-color: rgba(251, 191, 36, 0); }
}

.highlight-rating {
  animation: highlight 2.5s ease-in-out;
}

.highlight-comment {
  animation: highlight 2.5s ease-in-out;
}

@keyframes shrink-width {
  from { width: 100%; }
  to { width: 0%; }
}

.progress-bar-animate {
  animation: shrink-width linear forwards;
}