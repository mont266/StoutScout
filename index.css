@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html,
  body,
  #root {
    @apply h-full;
    /* This ensures a consistent height chain for the app to fill the viewport */
  }

  html {
    /* Prevent horizontal scrollbars which can cause unwanted white space */
    overflow-x: hidden;
  }

  body {
    @apply bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-white font-sans antialiased;
    /* Prevent the browser's native pull-to-refresh action */
    overscroll-behavior-y: contain;
    /* Add padding for device notches and system UI (status bar, home indicator) */
    padding-top: env(safe-area-inset-top);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
}

@layer components {
  /* This class is used in MobileLayout.jsx to add padding for the home indicator */
  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom);
  }

  /*
    Adds a colored strip at the bottom for native Android to provide spacing
    for the system navigation bar. This is needed because the webview does not
    respect safe-area-insets reliably for the bottom navigation bar.
    This is achieved using a flexbox pseudo-element (`::after`) within the
    main container. This method contains the spacing *within* the viewport height,
    preventing unwanted vertical scrolling.
  */
  .native-android .mobile-layout-container::after {
    content: '';
    display: block;
    height: 1rem; /* Creates the space at the bottom */
    flex-shrink: 0;
    background-color: #ffffff; /* Matches light mode Header/TabBar */
  }

  .dark.native-android .mobile-layout-container::after {
    background-color: #1f2937; /* Matches dark mode Header/TabBar (gray-800) */
  }
  
  /* New class to adjust scroll-to-top button on native Android */
  .native-android .scroll-to-top-android-fix {
    /* bottom-24 is 6rem. Add 2rem for the android nav bar padding. 8rem is bottom-32. */
    bottom: 8rem;
  }


  #orientation-lock-overlay {
    @apply fixed inset-0 z-[100] bg-gray-900 text-white flex-col items-center justify-center text-center p-8 hidden; /* hidden by default */
  }

  /* New styles for the improved overlay */
  .phone-graphic {
    @apply relative w-24 h-48;
    animation: rotate-hint 3s ease-in-out infinite;
  }
  
  .phone-outline, .stoutly-logo {
    @apply absolute top-0 left-0 w-full h-full;
  }

  .stoutly-logo {
    @apply p-6; /* Add padding to fit the logo nicely inside the phone */
  }

  @keyframes rotate-hint {
    0% { transform: rotate(90deg); }
    30% { transform: rotate(0deg); }
    70% { transform: rotate(0deg); }
    100% { transform: rotate(90deg); }
  }

  .app-header, .community-header, .feed-header {
    transition: transform 0.3s ease-in-out;
  }
  .app-header.hide-header, .community-header.hide-header, .feed-header.hide-header {
      transform: translateY(-100%);
  }

  .community-tabs-container {
    transition: all 0.3s ease-in-out;
    max-height: 6rem; /* A safe large value */
    overflow: hidden;
  }
  .community-tabs-container.hide {
      max-height: 0;
      border-bottom-width: 0;
      opacity: 0;
  }

  /* St. Paddy's Day Theme Overrides */
  .st-paddys-mode {
    --st-paddys-green-500: #22c55e;
    --st-paddys-green-400: #4ade80;
    --st-paddys-green-600: #16a34a;
    --st-paddys-dark-bg: hsl(140, 80%, 8%);
  }

  .st-paddys-mode body {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32' fill='none' stroke='rgb(255 255 255 / 0.05)'%3e%3cpath d='M16,27 L16,15 M16,15 C20,15 23,12 23,8 C23,4 20,1 16,1 C12,1 9,4 9,8 C9,12 12,15 16,15 M16,15 C12,19 8,20 6,17 C4,14 6,11 9,10 C12,9 15,11 16,15 M16,15 C20,19 24,20 26,17 C28,14 26,11 23,10 C20,9 17,11 16,15 Z' stroke-width='2'/%3e%3c/svg%3e");
    background-color: hsl(140, 80%, 4%);
  }

  .st-paddys-mode.dark body {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32' fill='none' stroke='rgb(255 255 255 / 0.05)'%3e%3cpath d='M16,27 L16,15 M16,15 C20,15 23,12 23,8 C23,4 20,1 16,1 C12,1 9,4 9,8 C9,12 12,15 16,15 M16,15 C12,19 8,20 6,17 C4,14 6,11 9,10 C12,9 15,11 16,15 M16,15 C20,19 24,20 26,17 C28,14 26,11 23,10 C20,9 17,11 16,15 Z' stroke-width='2'/%3e%3c/svg%3e");
  }

  .st-paddys-mode .dark\:bg-gray-900 { @apply dark:bg-[var(--st-paddys-dark-bg)]; }
  .st-paddys-mode .dark\:bg-gray-800 { @apply dark:bg-green-950/50; }
  .st-paddys-mode .stoutly-logo-stroke { stroke: var(--st-paddys-green-500); }

  .st-paddys-mode .text-amber-500 { color: var(--st-paddys-green-500); }
  .st-paddys-mode .dark .text-amber-400 { color: var(--st-paddys-green-400); }
  .st-paddys-mode .bg-amber-500 { background-color: var(--st-paddys-green-500); }
  .st-paddys-mode .border-amber-500 { border-color: var(--st-paddys-green-500); }
  .st-paddys-mode .accent-amber-500 { accent-color: var(--st-paddys-green-500); }
  .st-paddys-mode .hover\:text-amber-600:hover { color: var(--st-paddys-green-600); }
  .st-paddys-mode .dark .hover\:text-amber-400:hover { color: var(--st-paddys-green-400); }
  .st-paddys-mode .focus\:ring-amber-500:focus { --tw-ring-color: var(--st-paddys-green-500); }
  .st-paddys-mode .text-amber-600 { color: var(--st-paddys-green-600); }
  .st-paddys-mode .dark .text-amber-300 { color: #86efac; /* green-300 */ }
  .st-paddys-mode .from-amber-100 { --tw-gradient-from: #dcfce7; --tw-gradient-to: rgba(220, 252, 231, 0); }
  .st-paddys-mode .dark\:to-amber-900 { --tw-gradient-to: #14532d; }
  .st-paddys-mode .bg-amber-500\/10 { background-color: rgba(34, 197, 94, 0.1); }
  .st-paddys-mode .text-amber-700 { color: #15803d; }
  .st-paddys-mode .dark\:text-amber-300 { color: #86efac; }
  .st-paddys-mode .border-amber-400 { border-color: var(--st-paddys-green-400); }
}

/* Show overlay and hide app only on mobile devices in landscape.
   We use max-height as a proxy for a phone, as a phone's height in landscape
   is much smaller than its width, and smaller than a tablet's height. */
@media (orientation: landscape) and (max-height: 600px) {
  #root, #modal-root {
    display: none; /* Hide the app content */
  }
  #orientation-lock-overlay {
    display: flex; /* Show the overlay */
  }
}

.map-tiles-dark {
  filter: brightness(1.4) contrast(0.9) saturate(0.9);
}

@keyframes highlight {
  0% { background-color: rgba(251, 191, 36, 0); } /* amber-400 */
  50% { background-color: rgba(251, 191, 36, 0.3); }
  100% { background-color: rgba(251, 191, 36, 0); }
}

.highlight-rating {
  animation: highlight 2.5s ease-in-out;
}

.highlight-comment {
  animation: highlight 2.5s ease-in-out;
}

@keyframes shrink-width {
  from { width: 100%; }
  to { width: 0%; }
}

.progress-bar-animate {
  animation: shrink-width linear forwards;
}